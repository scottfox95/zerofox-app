-- ISO 27001 Controls Ingestion Script
-- Run this directly in your Neon database console

-- Create the ISO 27001 controls table
CREATE TABLE IF NOT EXISTS iso27001_controls (
  id SERIAL PRIMARY KEY,
  control_id VARCHAR(10) UNIQUE NOT NULL,
  title VARCHAR(500) NOT NULL,
  requirement_text TEXT NOT NULL,
  system_level BOOLEAN NOT NULL,
  category VARCHAR(100) NOT NULL,
  subcategory VARCHAR(100) NOT NULL,
  control_type TEXT[] NOT NULL DEFAULT '{}',
  op_capabilities TEXT[] NOT NULL DEFAULT '{}',
  references_text TEXT NOT NULL DEFAULT '',
  dti VARCHAR(50) NOT NULL DEFAULT '',
  dtc VARCHAR(50) NOT NULL DEFAULT '',
  subcontrols_count INTEGER NOT NULL DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Insert all 93 ISO 27001 controls with cleaning applied
INSERT INTO iso27001_controls (control_id, title, requirement_text, system_level, category, subcategory, control_type, op_capabilities, references_text, dti, dtc, subcontrols_count) VALUES
('A.5.1', 'policies for information security', 'information security policy and topic-specific policies should be defined, approved by management,published, communicated to and acknowledged by relevant personnel and relevant interested parties,and reviewed at planned intervals and if significant changes occur.', false, 'organizational control', 'organizational control', '{preventive}', '{governance}', '', 'easy', 'easy', 0),
('A.5.2', 'information security roles and responsibilities', 'information security roles and responsibilities should be defined and allocated according to the organization needs.', false, 'organizational control', 'organizational control', '{preventive}', '{governance}', '', 'easy', 'easy', 0),
('A.5.3', 'segregation of duties', 'conflicting duties and conflicting areas of responsibility should be segregated.', false, 'organizational control', 'organizational control', '{preventive}', '{governance,"identity and access management"}', '', 'easy', 'easy', 0),
('A.5.4', 'management responsibilities', 'management should require all personnel to apply information security in accordance with the established information security policy, topic-specific policies and procedures of the organization', false, 'organizational control', 'organizational control', '{preventive}', '{governance}', '', 'easy', 'easy', 0),
('A.5.5', 'contact with authorities', 'the organization should establish and maintain contact with relevant authorities.', false, 'organizational control', 'organizational control', '{preventive,corrective}', '{governance}', '', 'easy', 'easy', 0),
('A.5.6', 'contact with special interest groups', 'the organization should establish and maintain contact with special interest groups or other specialist security forums and professional associations.', false, 'organizational control', 'organizational control', '{preventive,corrective}', '{governance}', '', 'easy', 'easy', 0),
('A.5.7', 'threat intelligence', 'information relating to information security threats should be collected and analysed to produce threat intelligence.', false, 'organizational control', 'organizational control', '{preventive,corrective,detective}', '{"threat and vulnerability management"}', '', 'easy', 'easy', 0),
('A.5.8', 'information security in project management', 'information security should be integrated into project management.', false, 'organizational control', 'organizational control', '{preventive}', '{governance}', '', 'easy', 'easy', 0),
('A.5.9', 'inventory of information and other associated assets', 'an inventory of information and other associated assets, including owners, should be developed and maintained.', false, 'organizational control', 'organizational control', '{preventive}', '{"asset management"}', '', 'easy', 'easy', 0),
('A.5.10', 'acceptable use of information and other associated assets', 'rules for the acceptable use and procedures for handling information and other associated assets should be identified, documented and implemented.', false, 'organizational control', 'organizational control', '{preventive}', '{"asset management","information protection"}', '', 'easy', 'easy', 0),
('A.5.11', 'return of assets', 'personnel and other interested parties as appropriate should return all the organization''s assets in their possession upon change or termination of their employment, contract or agreement.', false, 'organizational control', 'organizational control', '{preventive}', '{"asset management"}', '', 'easy', 'easy', 0),
('A.5.12', 'classification of information', 'information should be classified according to the information security needs of the organization based on confidentiality, integrity, availability and relevant interested party requirements.', false, 'organizational control', 'organizational control', '{preventive}', '{"information protection"}', '', 'easy', 'easy', 0),
('A.5.13', 'labelling of information', 'an appropriate set of procedures for information labelling should be developed and implemented in accordance with the information classification scheme adopted by the organization.', false, 'organizational control', 'organizational control', '{preventive}', '{"information protection"}', '', 'easy', 'easy', 0),
('A.5.14', 'information transfer', 'information transfer rules, procedures, or agreements should be in place for all types of transfer facilities within the organization and between the organization and other parties.', false, 'organizational control', 'organizational control', '{preventive}', '{"asset management","information protection"}', '', 'easy', 'easy', 0),
('A.5.15', 'access control', 'rules to control physical and logical access to information and other associated assets should be established and implemented based on business and information security requirements.', false, 'organizational control', 'organizational control', '{preventive}', '{"identity and access management"}', '', 'easy', 'easy', 0),
('A.5.16', 'identity management', 'the full life cycle of identities should be managed.', false, 'organizational control', 'organizational control', '{preventive}', '{"identity and access management"}', '', 'easy', 'easy', 0),
('A.5.17', 'authentication information', 'allocation and management of authentication information should be controlled by a management process, including advising personnel on the appropriate handling of authentication information', false, 'organizational control', 'organizational control', '{preventive}', '{"identity and access management"}', '', 'easy', 'easy', 0),
('A.5.18', 'access rights', 'access rights to information and other associated assets should be provisioned, reviewed, modified and removed in accordance with the organization''s topic-specific policy on and rules for access control.', false, 'organizational control', 'organizational control', '{preventive}', '{"identity and access management"}', '', 'easy', 'easy', 0),
('A.5.19', 'information security in supplier relationships', 'processes and procedures should be defined and implemented to manage the information security risks associated with the use of supplier''s products or services', false, 'organizational control', 'organizational control', '{preventive}', '{"supplier relationship security"}', '', 'easy', 'easy', 0),
('A.5.20', 'addressing information security within supplier agreements', 'relevant information security requirements should be established and agreed with each supplier based on the type of supplier relationship.', false, 'organizational control', 'organizational control', '{preventive}', '{"supplier relationship security"}', '', 'easy', 'easy', 0),
('A.5.21', 'managing information security in the ict supply chain', 'processes and procedures should be defined and implemented to manage the information security risks associated with the ict products and services supply chain.', false, 'organizational control', 'organizational control', '{preventive}', '{"supplier relationship security"}', '', 'easy', 'easy', 0),
('A.5.22', 'monitoring, review and change management of supplier services', 'the organization should regularly monitor, review, evaluate and manage change in supplier information security practices and service delivery.', false, 'organizational control', 'organizational control', '{preventive}', '{"supplier relationship security"}', '', 'easy', 'easy', 0),
('A.5.23', 'information security for use of cloud services', 'processes for acquisition, use, management and exit from cloud services should be established in accordance with the organization''s information security requirements.', false, 'organizational control', 'organizational control', '{preventive}', '{"supplier relationship security"}', '', 'easy', 'easy', 0),
('A.5.24', 'information security incident management planning and preparation', 'the organization should plan and prepare for managing information security incidents by defining, establishing and communicating information security incident management processes, roles and responsibilities.', false, 'organizational control', 'organizational control', '{corrective}', '{governance,"information security event management"}', '', 'easy', 'easy', 0),
('A.5.25', 'assessment and decision on information security events', 'the organization should assess information security events and decide if they are to be categorized as information security incidents.', false, 'organizational control', 'organizational control', '{detective}', '{"information security event management"}', '', 'easy', 'easy', 0),
('A.5.26', 'response to information security incidents', 'information security incidents should be responded to in accordance with the documented procedures.', false, 'organizational control', 'organizational control', '{corrective}', '{"information security event management"}', '', 'easy', 'easy', 0),
('A.5.27', 'learning from information security incidents', 'knowledge gained from information security incidents should be used to strengthen and improve the information security controls.', false, 'organizational control', 'organizational control', '{preventive}', '{"information security event management"}', '', 'easy', 'easy', 0),
('A.5.28', 'collection of evidence', 'the organization should establish and implement procedures for the identification, collection, acquisition and preservation of evidence related to information security events.', false, 'organizational control', 'organizational control', '{corrective}', '{"information security event management"}', '', 'easy', 'easy', 0),
('A.5.29', 'information security during disruption', 'the organization should plan how to maintain information security at an appropriate level during disruption.', false, 'organizational control', 'organizational control', '{preventive,corrective}', '{continuity}', '', 'easy', 'easy', 0),
('A.5.30', 'ict readiness for business continuity', 'ict readiness should be planned, implemented, maintained and tested based on business continuity objectives and ict continuity requirements', false, 'organizational control', 'organizational control', '{corrective}', '{continuity}', '', 'easy', 'easy', 0),
('A.5.31', 'legal, statutory, regulatory and contractual requirements', 'legal, statutory, regulatory and contractual requirements relevant to information security and the organization''s approach to meet these requirements should be identified, documented and kept up to date.', false, 'organizational control', 'organizational control', '{preventive}', '{"legal and compliance"}', '', 'easy', 'easy', 0),
('A.5.32', 'intellectual property rights', 'the organization should implement appropriate procedures to protect intellectual property rights.', false, 'organizational control', 'organizational control', '{preventive}', '{"legal and compliance"}', '', 'easy', 'easy', 0),
('A.5.33', 'protection of records', 'records should be protected from loss, destruction, falsification, unauthorized access and unauthorized release.', false, 'organizational control', 'organizational control', '{preventive}', '{"legal and compliance","asset management","information protection"}', '', 'easy', 'easy', 0),
('A.5.34', 'privacy and protection of pii', 'the organization should identify and meet the requirements regarding the preservation of privacy and protection of pii according to applicable laws and regulations and contractual requirements.', false, 'organizational control', 'organizational control', '{preventive}', '{"legal and compliance","information protection"}', '', 'easy', 'easy', 0),
('A.5.35', 'independent review of information security', 'the organization''s approach to managing information security and its implementation including people, processes and technologies should be reviewed independently at planned intervals, or when significant changes occur', false, 'organizational control', 'organizational control', '{preventive,corrective}', '{"information security assurance"}', '', 'easy', 'easy', 0),
('A.5.36', 'compliance with policies, rules and standards for information security', 'compliance with the organization''s information security policy, topic-specific policies, rules and standards should be regularly reviewed.', false, 'organizational control', 'organizational control', '{preventive}', '{"legal and compliance","information security assurance"}', '', 'easy', 'easy', 0),
('A.5.37', 'documented operating procedures', 'operating procedures for information processing facilities should be documented and made available to personnel who need them.', false, 'organizational control', 'organizational control', '{preventive,corrective}', '{"asset management","physical security","system and network security","application security","secure configuration","identity and access management","threat and vulnerability management",continuity,"information security event management"}', '', 'easy', 'easy', 0),
('A.6.1', 'screening', 'background verification checks on all candidates to become personnel should be carried out prior to joining the organization and on an ongoing basis taking into consideration applicable laws, regulations and ethics and be proportional to the business requirements, the classification of the information to be accessed and the perceived risks.', false, 'people control', 'people control', '{preventive}', '{"human resource security"}', '', 'easy', 'easy', 0),
('A.6.2', 'terms and conditions of employment', 'the employment contractual agreements should state the personnel''s and the organization''s responsibilities for information security.', false, 'people control', 'people control', '{preventive}', '{"human resource security"}', '', 'easy', 'easy', 0),
('A.6.3', 'information security awareness, education and training', 'personnel of the organization and relevant interested parties should receive appropriate information security awareness, education and training and regular updates of the organization''s information security policy, topic-specific policies and procedures, as relevant for their job function.', false, 'people control', 'people control', '{preventive}', '{"human resource security"}', '', 'easy', 'easy', 0),
('A.6.4', 'disciplinary process', 'a disciplinary process should be formalized and communicated to take actions against personnel and other relevant interested parties who have committed an information security policy violation.', false, 'people control', 'people control', '{preventive,corrective}', '{"human resource security"}', '', 'easy', 'easy', 0),
('A.6.5', 'responsibilities after termination or change of employment', 'information security responsibilities and duties that remain valid after termination or change of employment should be defined, enforced and communicated to relevant personnel and other interested parties', false, 'people control', 'people control', '{preventive}', '{"human resource security","asset management"}', '', 'easy', 'easy', 0),
('A.6.6', 'confidentiality or non-disclosure agreements', 'confidentiality or non-disclosure agreements reflecting the organization''s needs for the protection of information should be identified, documented, regularly reviewed and signed by personnel and other relevant interested parties.', false, 'people control', 'people control', '{preventive}', '{"human resource security","information protection","supplier relationships"}', '', 'easy', 'easy', 0),
('A.6.7', 'remote working', 'security measures should be implemented when personnel are working remotely to protect information accessed, processed or stored outside the organization''s premises.', false, 'people control', 'people control', '{preventive}', '{"asset management","information protection","physical security","system and network security"}', '', 'easy', 'easy', 0),
('A.6.8', 'information security event reporting', 'the organization should provide a mechanism for personnel to report observed or suspected information security events through appropriate channels in a timely manner.', false, 'people control', 'people control', '{detective}', '{"information security event management"}', '', 'easy', 'easy', 0),
('A.7.1', 'physical security perimeters', 'security perimeters should be defined and used to protect areas that contain information and other associated assets.', false, 'physical control', 'physical control', '{preventive}', '{"physical security"}', '', 'easy', 'easy', 0),
('A.7.2', 'physical entry', 'secure areas should be protected by appropriate entry controls and access points.', false, 'physical control', 'physical control', '{preventive}', '{"physical security","identity and access management"}', '', 'easy', 'easy', 0),
('A.7.3', 'securing offices, rooms and facilities', 'physical security for offices, rooms and facilities should be designed and implemented.', false, 'physical control', 'physical control', '{preventive}', '{"physical security","asset management"}', '', 'easy', 'easy', 0),
('A.7.4', 'physical security monitoring', 'premises should be continuously monitored for unauthorized physical access.', false, 'physical control', 'physical control', '{preventive,detective}', '{"physical security"}', '', 'easy', 'easy', 0),
('A.7.5', 'protecting against physical and environmental threats', 'protection against physical and environmental threats, such as natural disasters and other intentional or unintentional physical threats to infrastructure should be designed and implemented.', false, 'physical control', 'physical control', '{preventive}', '{"physical security"}', '', 'easy', 'easy', 0),
('A.7.6', 'working in secure areas', 'security measures for working in secure areas should be designed and implemented.', false, 'physical control', 'physical control', '{preventive}', '{"physical security"}', '', 'easy', 'easy', 0),
('A.7.7', 'clear desk and clear screen', 'clear desk rules for papers and removable storage media and clear screen rules for information processing facilities should be defined and appropriately enforced.', false, 'physical control', 'physical control', '{preventive}', '{"physical security"}', '', 'easy', 'easy', 0),
('A.7.8', 'equipment siting and protection', 'equipment should be sited securely and protected.', false, 'physical control', 'physical control', '{preventive}', '{"physical security","asset management"}', '', 'easy', 'easy', 0),
('A.7.9', 'security of assets off-premises', 'off-site assets should be protected', false, 'physical control', 'physical control', '{preventive}', '{"physical security","asset management"}', '', 'easy', 'easy', 0),
('A.7.10', 'storage media', 'storage media should be managed through their life cycle of acquisition, use, transportation and disposal in accordance with the organization''s classification scheme and handling requirements.', false, 'physical control', 'physical control', '{preventive}', '{"physical security","asset management"}', '', 'easy', 'easy', 0),
('A.7.11', 'supporting utilities', 'information processing facilities should be protected from power failures and other disruptions caused by failures in supporting utilities.', false, 'physical control', 'physical control', '{preventive,detective}', '{"physical security"}', '', 'easy', 'easy', 0),
('A.7.12', 'cabling security', 'cables carrying power, data or supporting information services should be protected from interception, interference or damage. cabling security', false, 'physical control', 'physical control', '{preventive}', '{"physical security"}', '', 'easy', 'easy', 0),
('A.7.13', 'equipment maintenance', 'equipment should be maintained correctly to ensure availability, integrity and confidentiality of information.', false, 'physical control', 'physical control', '{preventive}', '{"physical security","asset management"}', '', 'easy', 'easy', 0),
('A.7.14', 'secure disposal or re-use of equipment', 'items of equipment containing storage media should be verified to ensure that any sensitive data and licensed software has been removed or securely overwritten prior to disposal or re-use.', false, 'physical control', 'physical control', '{preventive}', '{"physical security","asset management"}', '', 'easy', 'easy', 0),
('A.8.1', 'user endpoint devices', 'information stored on, processed by or accessible via user endpoint devices should be protected.', true, 'technological control', 'technological control', '{preventive}', '{"asset management","information protection"}', '', 'easy', 'easy', 0),
('A.8.2', 'privileged access rights', 'the allocation and use of privileged access rights should be restricted and managed.', true, 'technological control', 'technological control', '{preventive}', '{"identity and access management"}', '', 'easy', 'easy', 0),
('A.8.3', 'information access restriction', 'access to information and other associated assets should be restricted in accordance with the established topic-specific policy on access control.', true, 'technological control', 'technological control', '{preventive}', '{"identity and access management"}', '', 'easy', 'easy', 0),
('A.8.4', 'access to source code', 'read and write access to source code, development tools and software libraries should be appropriately managed.', true, 'technological control', 'technological control', '{preventive}', '{"identity and access management","application security","secure configuration"}', '', 'easy', 'easy', 0),
('A.8.5', 'secure authentication', 'secure authentication technologies and procedures should be implemented based on information access restrictions and the topic-specific policy on access control', true, 'technological control', 'technological control', '{preventive}', '{"identity and access management"}', '', 'easy', 'easy', 0),
('A.8.6', 'capacity management', 'the use of resources should be monitored and adjusted in line with current and expected capacity requirements.', true, 'technological control', 'technological control', '{preventive,detective}', '{continuity}', '', 'easy', 'easy', 0),
('A.8.7', 'protection against malware', 'protection against malware should be implemented and supported by appropriate user awareness.', true, 'technological control', 'technological control', '{preventive,detective,corrective}', '{"system and network security","information protection"}', '', 'easy', 'easy', 0),
('A.8.8', 'management of technical vulnerabilities', 'information about technical vulnerabilities of information systems in use should be obtained, the organization''s exposure to such vulnerabilities should be evaluated and appropriate measures should be taken.', true, 'technological control', 'technological control', '{preventive}', '{"threat and vulnerability management"}', '', 'easy', 'easy', 0),
('A.8.9', 'configuration management', 'configurations, including security configurations, of hardware, software, services and networks should be established, documented, implemented, monitored and reviewed', true, 'technological control', 'technological control', '{preventive}', '{"secure configuration"}', '', 'easy', 'easy', 0),
('A.8.10', 'information deletion', 'information stored in information systems, devices or in any other storage media should be deleted when no longer required.', true, 'technological control', 'technological control', '{preventive}', '{"information protection","legal and compliance"}', '', 'easy', 'easy', 0),
('A.8.11', 'data masking', 'data masking should be used in accordance with the organization''s topic-specific policy on access control and other related topic-specific policies, and business requirements, taking applicable legislation into consideration.', true, 'technological control', 'technological control', '{preventive}', '{"information protection"}', '', 'easy', 'easy', 0),
('A.8.12', 'data leakage prevention', 'data leakage prevention measures should be applied to systems, networks and any other devices that process, store or transmit sensitive information.', true, 'technological control', 'technological control', '{preventive,detective}', '{"information protection"}', '', 'easy', 'easy', 0),
('A.8.13', 'information backup', 'backup copies of information, software and systems should be maintained and regularly tested in accordance with the agreed topic-specific policy on backup.', true, 'technological control', 'technological control', '{corrective}', '{continuity}', '', 'easy', 'easy', 0),
('A.8.14', 'redundancy of information processing facilities', 'information processing facilities should be implemented with redundancy sufficient to meet availability requirements.', true, 'technological control', 'technological control', '{preventive}', '{continuity,"asset management"}', '', 'easy', 'easy', 0),
('A.8.15', 'logging', 'logs that record activities, exceptions, faults and other relevant events should be produced, stored, protected and analysed.', true, 'technological control', 'technological control', '{detective}', '{"information security event management"}', '', 'easy', 'easy', 0),
('A.8.16', 'monitoring activities', 'networks, systems and applications should be monitored for anomalous behaviour and appropriate actions taken to evaluate potential information security incidents.', true, 'technological control', 'technological control', '{detective,corrective}', '{"information security event management"}', '', 'easy', 'easy', 0),
('A.8.17', 'clock synchronization', 'the clocks of information processing systems used by the organization should be synchronized to approved time sources.', true, 'technological control', 'technological control', '{detective}', '{"information security event management"}', '', 'easy', 'easy', 0),
('A.8.18', 'use of privileged utility programs', 'the use of utility programs that can be capable of overriding system and application controls should be restricted and tightly controlled', true, 'technological control', 'technological control', '{preventive}', '{"system and network security","secure configuration","application security"}', '', 'easy', 'easy', 0),
('A.8.19', 'installation of software on operational systems', 'procedures and measures should be implemented to securely manage software installation on operational systems.', true, 'technological control', 'technological control', '{preventive}', '{"secure configuration","application security"}', '', 'easy', 'easy', 0),
('A.8.20', 'networks security', 'networks and network devices should be secured, managed and controlled to protect information in systems and applications', true, 'technological control', 'technological control', '{preventive,detective}', '{"system and network security"}', '', 'easy', 'easy', 0),
('A.8.21', 'security of network services', 'security mechanisms, service levels and service requirements of network services should be identified, implemented and monitored.', true, 'technological control', 'technological control', '{preventive}', '{"system and network security"}', '', 'easy', 'easy', 0),
('A.8.22', 'segregation of networks', 'groups of information services, users and information systems should be segregated in the organization''s networks.', true, 'technological control', 'technological control', '{preventive}', '{"system and network security"}', '', 'easy', 'easy', 0),
('A.8.23', 'web filtering', 'access to external websites should be managed to reduce exposure to malicious content.', true, 'technological control', 'technological control', '{preventive}', '{"system and network security"}', '', 'easy', 'easy', 0),
('A.8.24', 'use of cryptography', 'rules for the effective use of cryptography, including cryptographic key management, should be defined and implemented.', true, 'technological control', 'technological control', '{preventive}', '{"secure configuration"}', '', 'easy', 'easy', 0),
('A.8.25', 'secure development life cycle', 'rules for the secure development of software and systems should be established and applied.', true, 'technological control', 'technological control', '{preventive}', '{"system and network security","application security"}', '', 'easy', 'easy', 0),
('A.8.26', 'application security requirements', 'information security requirements should be identified, specified and approved when developing or acquiring applications.', true, 'technological control', 'technological control', '{preventive}', '{"system and network security","application security"}', '', 'easy', 'easy', 0),
('A.8.27', 'secure system architecture and engineering principles', 'principles for engineering secure systems should be established, documented, maintained and applied to any information system development activities.', true, 'technological control', 'technological control', '{preventive}', '{"system and network security","application security"}', '', 'easy', 'easy', 0),
('A.8.28', 'secure coding', 'secure coding principles should be applied to software development.', true, 'technological control', 'technological control', '{preventive}', '{"system and network security","application security"}', '', 'easy', 'easy', 0),
('A.8.29', 'security testing in development and acceptance', 'security testing processes should be defined and implemented in the development life cycle.', true, 'technological control', 'technological control', '{preventive}', '{"system and network security","application security","information security assurance"}', '', 'easy', 'easy', 0),
('A.8.30', 'outsourced development', 'the organization should direct, monitor and review the activities related to outsourced system development.', true, 'technological control', 'technological control', '{preventive,detective}', '{"system and network security","application security","supplier relationships security"}', '', 'easy', 'easy', 0),
('A.8.31', 'separation of development, test and production environments', 'development, testing and production environments should be separated and secured.', true, 'technological control', 'technological control', '{preventive}', '{"system and network security","application security"}', '', 'easy', 'easy', 0),
('A.8.32', 'change management', 'changes to information processing facilities and information systems should be subject to change management procedures.', true, 'technological control', 'technological control', '{preventive}', '{"system and network security","application security"}', '', 'easy', 'easy', 0),
('A.8.33', 'test information', 'test information should be appropriately selected, protected and managed.', true, 'technological control', 'technological control', '{preventive}', '{"information protection"}', '', 'easy', 'easy', 0),
('A.8.34', 'protection of information systems during audit testing', 'audit tests and other assurance activities involving assessment of operational systems should be planned and agreed between the tester and appropriate management.', true, 'technological control', 'technological control', '{preventive}', '{"system and network security","information protection"}', '', 'easy', 'easy', 0)
ON CONFLICT (control_id) DO UPDATE SET
  title = EXCLUDED.title,
  requirement_text = EXCLUDED.requirement_text,
  system_level = EXCLUDED.system_level,
  category = EXCLUDED.category,
  subcategory = EXCLUDED.subcategory,
  control_type = EXCLUDED.control_type,
  op_capabilities = EXCLUDED.op_capabilities,
  references_text = EXCLUDED.references_text,
  dti = EXCLUDED.dti,
  dtc = EXCLUDED.dtc,
  subcontrols_count = EXCLUDED.subcontrols_count,
  updated_at = CURRENT_TIMESTAMP;

-- Acceptance checks
SELECT 'Total control count:' as check_type, COUNT(*) as result FROM iso27001_controls;
SELECT 'A.5.1 details:' as check_type, control_id, title, category, control_type FROM iso27001_controls WHERE control_id = 'A.5.1';
SELECT 'Duplicate check:' as check_type, control_id, COUNT(*) as count FROM iso27001_controls GROUP BY control_id HAVING COUNT(*) > 1;